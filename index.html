<!DOCTYPE html>
<html lang="en">

<head>
    <title>Black Jack</title>
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <style>
        .myDiv {
            border: 5px;
            text-align: center;
        }

        .button {
            background-color: rgb(251, 200, 200);
            border: rgb(245, 84, 116);
            border-radius: 5px;
            color: rgb(0, 0, 0);
            padding: 5px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
        }

        .button:active {
            background-color: rgb(245, 143, 143);
            border: rgb(245, 84, 116);
            border-radius: 5px;
            color: rgb(0, 0, 0);
            padding: 5px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
        }

        .resize {
            width: 25%;
            height: 25%;
        }

        #busted {
            color: brown;
        }

    </style>
</head>

<body style="background-color:rgb(0, 0, 0);" onload="main()">
    <script>

        // for the buttons
        let stuck = false;
        let drawn = false;


        let gameState = "inital";
        function stick() {
            console.log("stick!");
            stuck = true;
            return;
        }
        function draw() {
            console.log("draw!");
            const drawnCard = drawCard();
            console.log("drawn:", drawnCard);
            const cardImgPath = cardpng(drawnCard[0], drawnCard[1]);
            console.log("path", cardImgPath);
            addImgToDisplay(cardImgPath);
            drawn = true;
            return;
        }

        function random(min, max) {
            return Math.floor(Math.random() * (max - min) + min);
        }


        function addImgToDisplay(imgPath) {
            const cardDisplayDiv = document.querySelector("#cardDisplay");
            console.log("cardDisplay", cardDisplayDiv);
            cardDisplayDiv.innerHTML = cardDisplayDiv.innerHTML 
            + '<img class="resize" src="images/' + imgPath + '" alt="10 of spades">';
        }

        function cardpng(x, y) {
            let card = x.concat(" of ", y);
            card = card.toLowerCase();
            card = card.replaceAll(" ", "_");
            card = card.concat(".png");
            console.log("Generated iamgePath:", card);
            return card;
        }

        function cardvalue(card, total) {
            if (card == "Ace") {
                if (total + 11 > 21) {
                    card = 1;
                }
                else {
                    card = 11;
                }
            }
            else if (card == "Jack" || card == "Queen" || card == "King") {
                card = 10;
            }
            else {
                card = parseInt(card);
            }
            return card;
        }

        function drawCard() {
            // TODO: be less lucky
            return ["Ace", "Spades"];
        }

        function main() {
            let bust = false;
            let total = 0;
            const cardSuits = ["Hearts", "Spades", "Diamonds", "Clubs"];
            const cardValues = ["Ace", "2", "3", "4", "5", "6", "7", "8", "9", "10", "Jack", "Queen", "King"];
            // make computer more likely to roll higher
            const weightedcomp = [10, 11, 12, 13, 13, 14, 14, 15, 15, 16, 16, 16, 17, 17, 17, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20]

            // the computer isnt going to pull cards
            const comp = weightedcomp[random(0, weightedcomp.length)];

            console.log("This is blackjack google the rules (ace rule included).");
            console.log("to start press 'ok'.");
            // begin 
            // first card 
            let a = cardSuits[random(0, cardSuits.length)];
            let b = cardValues[random(0, cardValues.length)];

            // second card 
            let c = cardSuits[random(0, cardSuits.length)];
            let d = cardValues[random(0, cardValues.length)];

            console.log("you drew:");
            console.log(b, "of", a);
            console.log(d, "of", c);

            // assigning card values 
            b = cardvalue(b, total);
            d = cardvalue(d, total);

            // total after drawing 2 cards 
            total = b + d;

            // whether to draw next card or not 
            /*while (bust == false)
            {
                while (true)
                {
                    if (draw)
                    {
                        let drawncard = y[random(0, y.length)];
                        let drawncardx = x[random(0, x.length)];
                        console.log("you drew ", drawncard, "of", drawncardx);
                        drawncard = cardvalue(drawncard, total);
                        total += drawncard;
                        if (total > 21)
                        {
                            bust = true;
                            continue;
                        }
                    }
                    else if (stick)
                    {
                        break;
                    }
                }
            }*/

            // game results 
            if (bust == true) {
                console.log("you busted, your total was: ", total, "computer got:", comp);
            }
            else {
                if (total > comp) {
                    console.log("you win! your total was: ", total, "computer got: ", comp);
                }
                else if (total < comp) {
                    console.log("you lose. your total was: ", total, "computer got: ", comp);
                }
                else {
                    console.log("you and computer drew with a score of: ", total);
                }
            }

        }

    </script>
    <h1 style="color:rgb(251, 200, 200); text-align: center;">Black Jack</h1>
    <p style="color:rgb(251, 200, 200); text-align: center;">google the rules</p>
    <div id="cardDisplay" class="myDiv">
        <img class="resize" src="images/king_of_hearts.png" alt="king of hearts">
        <img class="resize" src="images/10_of_spades.png" alt="10 of spades">
    </div>
    <div class="myDiv">
        <button class="button" onclick="draw()">draw</button>
        <button class="button" onclick="stick()">stick</button>
    </div>
    <div id="busted">
        Busted!
    </div>
</body>

</html>